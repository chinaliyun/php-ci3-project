
<div class="content-main admin_edit">
	<div class="col-md-6 form">
        <p class="header">
            修改密码
        </p>
         <form role="form" autocomplete="off">
             <div class="form-group">
                 <label>旧密码</label>
                 <input type="password" class="form-control" id="oldpass" name="oldpass" placeholder="请输入旧密码">
             </div>
             <div class="form-group">
                 <label>新密码</label>
                 <input type="password" class="form-control" id="newpass" name="newpass" placeholder="请输入新密码">
             </div>
             <div class="form-group">
                 <label>重复密码</label>
                 <input type="password" class="form-control" id="repass" name="repass" placeholder="请重复输入新密码">
             </div>
             <a href="javascript:;" type="submit" class="btn btn-primary submit">提交</a>
         </form>   
    </div>
</div>
<script type="text/javascript">
    $(function(){
        $('a.submit').click(function(){
            var form = $('form').get(0);
            var data = {
                'oldpass': form.oldpass.value,
                'newpass': form.newpass.value,
                'repass': form.repass.value
            };
            if(data.oldpass.length == 0){
                alert('请输入原密码');return false;
            }
            if(data.newpass.length == 0){
                alert('请输入新密码');return false;
            }
            if(data.repass.length == 0){
                alert('请再次输入密码');return false;
            }
            if(data.newpass != data.repass){
                alert('新密码输入不一致，请重新输入');return false;
            }
            $('form').ajaxSubmit({
                url: "<?php echo site_url('admin/home/user_send'); ?>",
                type: 'POST',
                success: function(res){
                    if(res == 1){
                        alert('修改成功，请重新登录');
                        location.href='/admin/login';
                    }
                    if(res == 0){
                        alert('旧密码不正确，请重新输入')
                    }
                    if(res == 2){
                        alert('修改密码失败，请联系管理员');
                    }
                },
                error: function(error){
                    alert('修改失败，请联系管理员')
                }
            })
        })
    })
</script>
    

